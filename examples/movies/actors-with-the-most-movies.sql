/* 1. actors with the most number of movies */

SELECT 
	STARNAME,
	COUNT(*)
FROM
	STARSIN
GROUP BY
	STARSIN.STARNAME
HAVING 
	COUNT(*) = (
		SELECT TOP 1
			COUNT(*)
		FROM
			STARSIN
		GROUP BY
			STARSIN.STARNAME 
		ORDER BY 
			COUNT(*) DESC
	)

/* the same as above, but with join */
GO

/* 
CREATE VIEW PARTICIPATION
	AS
SELECT 
	S.STARNAME,
	COUNT(*) AS "OCOUNT"
FROM
	STARSIN S
GROUP BY
	S.STARNAME  */

SELECT 
	STARNAME,
	OCOUNT
FROM 
	PARTICIPATION P
INNER JOIN (
		SELECT TOP 1
			COUNT(*) AS ICOUNT
		FROM
			STARSIN
		GROUP BY
			STARSIN.STARNAME 
		ORDER BY 
			COUNT(*) DESC
	) O on (P.OCOUNT = O.ICOUNT)
	
